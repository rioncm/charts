{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "type": "object",
  "additionalProperties": true,
  "properties": {
    "namespace": {
      "type": "string",
      "default": "outline-project"
    },
    "nameOverride": {
      "type": "string"
    },
    "fullnameOverride": {
      "type": "string"
    },
    "replicaCount": {
      "type": "integer",
      "minimum": 1,
      "default": 1
    },
    "autoscaling": {
      "type": "object",
      "properties": {
        "enabled": {
          "type": "boolean",
          "default": false
        }
      }
    },
    "image": {
      "type": "object",
      "required": ["repository", "tag", "pullPolicy"],
      "properties": {
        "repository": {
          "type": "string",
          "default": "outlinewiki/outline"
        },
        "tag": {
          "type": "string",
          "default": "0.87.4"
        },
        "pullPolicy": {
          "type": "string",
          "enum": ["Always", "IfNotPresent", "Never"],
          "default": "IfNotPresent"
        }
      }
    },
    "serviceAccount": {
      "type": "object",
      "properties": {
        "create": { "type": "boolean" },
        "automount": { "type": "boolean" },
        "annotations": {
          "type": "object",
          "additionalProperties": { "type": "string" }
        },
        "name": { "type": "string" }
      }
    },
    "service": {
      "type": "object",
      "properties": {
        "type": {
          "type": "string",
          "enum": ["ClusterIP", "NodePort", "LoadBalancer"],
          "default": "ClusterIP"
        },
        "port": {
          "type": "integer",
          "minimum": 1,
          "maximum": 65535,
          "default": 3000
        },
        "annotations": {
          "type": "object",
          "additionalProperties": { "type": "string" }
        },
        "labels": {
          "type": "object",
          "additionalProperties": { "type": "string" }
        }
      }
    },
    "ingress": {
      "type": "object",
      "properties": {
        "enabled": { "type": "boolean" },
        "className": { "type": "string" },
        "annotations": {
          "type": "object",
          "additionalProperties": { "type": "string" }
        },
        "hosts": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "host": { "type": "string" },
              "paths": {
                "type": "array",
                "items": {
                  "type": "object",
                  "properties": {
                    "path": { "type": "string" },
                    "pathType": {
                      "type": "string",
                      "enum": ["Prefix", "Exact", "ImplementationSpecific"]
                    }
                  },
                  "required": ["path"]
                }
              }
            },
            "required": ["host", "paths"]
          }
        },
        "tls": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "secretName": { "type": "string" },
              "hosts": {
                "type": "array",
                "items": { "type": "string" }
              }
            },
            "required": ["secretName", "hosts"]
          }
        }
      }
    },
    "outline": {
      "type": "object",
      "required": ["url"],
      "properties": {
        "url": {
          "type": "string",
          "format": "uri"
        },
        "collaborationUrl": {
          "type": "string"
        },
        "cdnUrl": {
          "type": "string"
        },
        "webConcurrency": {
          "type": "integer",
          "minimum": 1
        },
        "defaultLanguage": { "type": "string" },
        "forceHttps": { "type": "boolean" },
        "enableUpdates": { "type": "boolean" },
        "debug": { "type": "string" },
        "logLevel": {
          "type": "string",
          "enum": ["error", "warn", "info", "http", "verbose", "debug", "silly"]
        }
      }
    },
    "secrets": {
      "type": "object",
      "properties": {
        "existingSecret": { "type": "string" }
      }
    },
    "database": {
      "type": "object",
      "properties": {
        "initialize": { "type": "boolean" },
        "url": { "type": "string" },
        "existingSecret": { "type": "string" },
        "existingSecretKey": { "type": "string" },
        "sslMode": {
          "type": "string",
          "enum": ["require", "disable", "prefer", "allow"],
          "default": "require"
        },
        "connectionPool": {
          "type": "object",
          "properties": {
            "min": { "type": "string" },
            "max": { "type": "string" }
          }
        }
      }
    },
    "redis": {
      "type": "object",
      "properties": {
        "enabled": { "type": "boolean" },
        "externalUrl": { "type": "string" },
        "image": {
          "type": "object",
          "properties": {
            "repository": { "type": "string" },
            "tag": { "type": "string" },
            "pullPolicy": {
              "type": "string",
              "enum": ["Always", "IfNotPresent", "Never"]
            }
          }
        },
        "resources": {
          "type": "object",
          "properties": {
            "requests": {
              "type": "object",
              "properties": {
                "cpu": { "type": "string" },
                "memory": { "type": "string" }
              }
            },
            "limits": {
              "type": "object",
              "properties": {
                "cpu": { "type": "string" },
                "memory": { "type": "string" }
              }
            }
          }
        }
      }
    },
    "fileStorage": {
      "type": "object",
      "properties": {
        "type": {
          "type": "string",
          "enum": ["local", "s3"],
          "default": "local"
        },
        "localRootDir": { "type": "string" },
        "uploadMaxSize": { "type": ["integer", "string"] },
        "importMaxSize": { "type": ["integer", "string"] },
        "workspaceImportMaxSize": { "type": ["integer", "string"] },
        "s3": {
          "type": "object",
          "properties": {
            "region": { "type": "string" },
            "accessKeyId": { "type": "string" },
            "secretAccessKey": { "type": "string" },
            "accelerateUrl": { "type": "string" },
            "maxUploadSize": { "type": ["integer", "string"] },
            "uploadBucketUrl": { "type": "string" },
            "uploadBucketName": { "type": "string" },
            "forcePathStyle": { "type": "boolean" },
            "acl": { "type": "string" }
          }
        }
      }
    },
    "persistence": {
      "type": "object",
      "properties": {
        "enabled": { "type": "boolean" },
        "storageClass": { "type": "string" },
        "accessModes": {
          "type": "array",
          "items": { "type": "string" }
        },
        "size": { "type": "string" },
        "annotations": {
          "type": "object",
          "additionalProperties": { "type": "string" }
        },
        "existingClaim": { "type": "string" }
      }
    },
    "rateLimiter": {
      "type": "object",
      "properties": {
        "enabled": { "type": "boolean" },
        "requests": { "type": "integer" },
        "durationWindow": { "type": "integer" }
      }
    },
    "resources": {
      "type": "object",
      "properties": {
        "requests": {
          "type": "object",
          "properties": {
            "cpu": { "type": "string" },
            "memory": { "type": "string" }
          }
        },
        "limits": {
          "type": "object",
          "properties": {
            "cpu": { "type": "string" },
            "memory": { "type": "string" }
          }
        }
      }
    },
    "livenessProbe": {
      "type": "object",
      "properties": {
        "enabled": { "type": "boolean" },
        "httpGet": {
          "type": "object",
          "properties": {
            "path": { "type": "string" },
            "port": { "type": ["string", "integer"] }
          }
        },
        "initialDelaySeconds": { "type": "integer" },
        "periodSeconds": { "type": "integer" },
        "timeoutSeconds": { "type": "integer" },
        "failureThreshold": { "type": "integer" }
      }
    },
    "readinessProbe": {
      "type": "object",
      "properties": {
        "enabled": { "type": "boolean" },
        "httpGet": {
          "type": "object",
          "properties": {
            "path": { "type": "string" },
            "port": { "type": ["string", "integer"] }
          }
        },
        "initialDelaySeconds": { "type": "integer" },
        "periodSeconds": { "type": "integer" },
        "timeoutSeconds": { "type": "integer" },
        "failureThreshold": { "type": "integer" }
      }
    }
  },
  "required": ["outline"]
}